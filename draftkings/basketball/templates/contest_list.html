{% extends 'base.html' %}

{% load dk_tags %}

{% block content %}
    <div class="container">
        <h1>
            Contests
        </h1>
        <table class="table table-striped">
            <thead>
            <tr>
                <th>Contest</th>
                <th>Entry Fee</th>
                <th>Entries</th>
                <th>Total Entries</th>
            </tr>
            </thead>
            <tbody>
            {% for contest in object_list %}
                <tr data-child-value="{{ forloop.counter0 }}">
                    <td><a class="contest-link" data-url="{% url 'contest' contest.pk %}" href="#">{{ contest }}</a></td>
                    <td>{{ contest.entry_fee }}</td>
                    <td>{{ contest.mult_entries_allowed }}</td>
                    <td>{{ contest.total_entries }}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="modal fade" tabindex="-1" role="dialog" id="contest-modal">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Contest</h4>
                </div>
                <div class="modal-body">
                    <p>One fine body&hellip;</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal">OK</button>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script>
        $(document).ready(function () {
            var table = $('.table').DataTable({
                "paging": false,
            });

            $(".contest-link").on("click", function (e) {
                e.preventDefault();
                $('#contest-modal').modal('show');

                var contest_url = $(this).data('url');
                var contest = $.ajax(contest_url);

                $('#contest-modal .modal-body').load(contest_url);
                $('#contest-modal .modal-header h4').text($(this).text());
            });

        });
    </script>
{% endblock %}
